<!DOCTYPE html>
<html lang="en">
	<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>A Snippet of ReactJS and Rails in Hoojah by Rudzainy Rahman</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="A Snippet of ReactJS and Rails in Hoojah">

		<!-- Bootstrap CSS & Icons-->
		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
		<!-- end Bootstrap CSS & Icons -->
		
		<link rel="stylesheet" type="text/css" href="../si-es-es.css">
	</head>
	<body>
		<!-- Top Navigation Bar -->
		<nav class="navbar navbar-expand-lg border-bottom border-warning">
			<div class="container">
				<a href="/" title="Wow! It's a Wau!" class="navbar-brand text-warning"><span class="visually-hidden">Rudzainy Rahman's Website</span>~|{·})</a>
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
		      <span class="navbar-toggler-icon"></span>
		    </button>
		    <div class="collapse navbar-collapse" id="navbarSupportedContent">
					<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
						<li class="nav-item">
							<a href="/work/" class="nav-link"><i class="bi bi-person-fill-gear me-2"></i>Work</a>
						</li>
						<li class="nav-item">
							<a href="/life/" class="nav-link"><i class="bi bi-person-hearts me-2"></i>Life</a>
						</li>
						<li class="nav-item">
							<a href="/balance/" class="nav-link"><i class="bi bi-person-lines-fill me-2"></i>Balance</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>
		<!-- end Top Navigation Bar -->

		<!-- Main Content Section -->
		<main class="container my-5">
			<article class="post-content">
				
<table>
  <tbody>
    <tr>
      <td>Project</td>
      <td>Hoojah</td>
    </tr>
    <tr>
      <td>Responsibilities</td>
      <td>Research, design and build</td>
    </tr>
    <tr>
      <td>Technology Stack</td>
      <td>HTML, SCSS, Adobe XD, Ruby on Rails, ReactJS, Discourse, Docker</td>
    </tr>
    <tr>
      <td>Year</td>
      <td>2013-2019</td>
    </tr>
    <tr>
      <td>Github Repo</td>
      <td><a href="https://github.com/orgs/hoojah/repositories">View in Github</a></td>
    </tr>
    <tr>
      <td>YouTube Videos</td>
      <td>Pitch: <a href="https://www.youtube.com/watch?v=xfG58Xcgmo4">Watch video</a> <br><a href="https://www.youtube.com/watch?v=1GEy17NS7H4">Tutorial (EN): Watch video</a> <br><a href="https://www.youtube.com/watch?v=5MBb-9cCbVs">Tutorial (BM): Watch video</a>
</td>
    </tr>
    <tr>
      <td>Behance</td>
      <td><a href="https://www.behance.net/gallery/175206951/Hoojah">View in Behance</a></td>
    </tr>
  </tbody>
</table>

<p>The Hoojah project has… wordpress, html css</p>

<p>The final iteration of Hoojah uses ReactJS on the frontend and Ruby on Rails on the backend.</p>

<h2 id="reactjs-because">ReactJS because…</h2>

<p>Here I will explain my solution for building a Hujah card component.</p>

<h2 id="hujah-card">Hujah Card</h2>

<p>``` javascript
// card.js</p>

<p>import React from ‘react’
import { Link } from ‘react-router-dom’
import Linkify from ‘react-linkify’
import AgreeIcon from ‘../Icons/agree’
import NeutralIcon from ‘../Icons/neutral’
import DisagreeIcon from ‘../Icons/disagree’
import ViewsIcon from ‘../Icons/views’
import VotesIcon from ‘../Icons/votes’
import HujahIcon from ‘../Icons/hujah’
import HujahCardHeader from ‘./card_header’
import ButtonAddHujah from ‘../Layouts/button_add_hujah’</p>

<p>class HujahCard extends React.Component {
  constructor(props) {
    super(props)</p>

<pre><code>const { hujah } = this.props
const { agree_count, neutral_count, disagree_count } = hujah.attributes

this.state = {
  hujah: hujah,
  hujahParentAvailable: hujah.attributes.hasOwnProperty("parent"),
  showAddHujahButton: hujah.attributes.current_user_vote !== null,
  totalVoteCount: agree_count + neutral_count + disagree_count
}   }
</code></pre>

<p>updateVote(vote) {
    const url = “/api/v1/votes/create”</p>

<pre><code>const body = {
  vote: vote,
  hujah_id: this.state.hujah.id,
  user_id: this.props.currentUser.id
}

const token = document.querySelector('meta[name="csrf-token"]').content

fetch(url, {
  method: "POST",
  headers: {
    "X-CSRF-Token": token,
    "Content-Type": "application/json"
  },
  body: JSON.stringify(body)
})
  .then(response =&gt; {
    if (response.ok) {
      return response.json()
    }
    throw new Error("Network response was not ok.")
  })
  .catch(error =&gt; console.log(error.message))   }
</code></pre>

<p>calculatePercentage(voteCount) {
    const percentage = voteCount * 100 / this.state.totalVoteCount
    return <code>${percentage}%</code>
  }</p>

<p>handleVoteAgree() {
    if(this.userNotLoggedIn()) {
      return this.redirectToLogin()
    }</p>

<pre><code>const newHujahState = Object.assign({}, this.state.hujah)

var addToTotalVoteCount = 0

if(newHujahState.attributes.current_user_vote == "agree") {
  return
} else {
  newHujahState.attributes.agree_count = newHujahState.attributes.agree_count + 1
  if(newHujahState.attributes.current_user_vote == "neutral") {
    newHujahState.attributes.neutral_count = newHujahState.attributes.neutral_count - 1
  } else if(newHujahState.attributes.current_user_vote == "disagree") {
    newHujahState.attributes.disagree_count = newHujahState.attributes.disagree_count - 1
  }
  if(newHujahState.attributes.current_user_vote == null) {
    addToTotalVoteCount = 1
  }
  newHujahState.attributes.current_user_vote = "agree"
}

this.setState((prevState, props) =&gt; {
  return {
    hujah: newHujahState,
    totalVoteCount: prevState.totalVoteCount + addToTotalVoteCount,
    showAddHujahButton: true
  }
})

this.updateVote(1)   }
</code></pre>

<p>handleVoteNeutral() {
    if(this.userNotLoggedIn()) {
      return this.redirectToLogin()
    }</p>

<pre><code>const newHujahState = Object.assign({}, this.state.hujah)

var addToTotalVoteCount = 0

if(newHujahState.attributes.current_user_vote == "neutral") {
  return
} else {
  newHujahState.attributes.neutral_count = newHujahState.attributes.neutral_count + 1
  if(newHujahState.attributes.current_user_vote == "agree") {
    newHujahState.attributes.agree_count = newHujahState.attributes.agree_count - 1
  } else if(newHujahState.attributes.current_user_vote == "disagree") {
    newHujahState.attributes.disagree_count = newHujahState.attributes.disagree_count - 1
  }
  if(newHujahState.attributes.current_user_vote == null) {
    addToTotalVoteCount = 1
  }
  newHujahState.attributes.current_user_vote = "neutral"
}

this.setState((prevState, props) =&gt; {
  return {
    hujah: newHujahState,
    totalVoteCount: prevState.totalVoteCount + addToTotalVoteCount,
    showAddHujahButton: true
  }
})

this.updateVote(2)   }
</code></pre>

<p>handleVoteDisagree() {
    if(this.userNotLoggedIn()) {
      return this.redirectToLogin()
    }</p>

<pre><code>const newHujahState = Object.assign({}, this.state.hujah)

var addToTotalVoteCount = 0

if(newHujahState.attributes.current_user_vote == "disagree") {
  return
} else {
  newHujahState.attributes.disagree_count = newHujahState.attributes.disagree_count + 1
  if(newHujahState.attributes.current_user_vote == "agree") {
    newHujahState.attributes.agree_count = newHujahState.attributes.agree_count - 1
  } else if(newHujahState.attributes.current_user_vote == "neutral") {
    newHujahState.attributes.neutral_count = newHujahState.attributes.neutral_count - 1
  }
  if(newHujahState.attributes.current_user_vote == null) {
    addToTotalVoteCount = 1
  }
  newHujahState.attributes.current_user_vote = "disagree"
}

this.setState((prevState, props) =&gt; {
  return {
    hujah: newHujahState,
    totalVoteCount: prevState.totalVoteCount + addToTotalVoteCount,
    showAddHujahButton: true
  }
})

this.updateVote(3)   }
</code></pre>

<p>userNotLoggedIn() {
    return !this.props.loggedInStatus
  }</p>

<p>redirectToLogin() {
    this.props.history.push(‘/start/login’)
  }</p>

<p>render() {
    // || this.state.hujah.attributes.children_count == 1
    if(this.state.hujahParentAvailable) {
      return null
    }</p>

<pre><code>const { hujah, hujahParentAvailable, showAddHujahButton, totalVoteCount } = this.state
const { agree_count, neutral_count, disagree_count, body, current_user_vote, children_count, user, slug } = hujah.attributes

const showVoteBar = (
  &lt;div className="card-body p-0"&gt;
    &lt;div className="d-flex justify-content-around vote-bar"&gt;
      &lt;div className="vote bg-agree" style={{ width: this.calculatePercentage(agree_count) }}&gt;&lt;/div&gt;
      &lt;div className="vote bg-neutral" style={{ width: this.calculatePercentage(neutral_count) }}&gt;&lt;/div&gt;
      &lt;div className="vote bg-disagree" style={{ width: this.calculatePercentage(disagree_count) }}&gt;&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
)

return(
    &lt;div className="shadow card border-0 rounded-0 mb-2"&gt;
      &lt;HujahCardHeader hujah={hujah} hujahParentAvailable={hujahParentAvailable} /&gt;
      &lt;div className="card-body pb-0"&gt;
        &lt;Link to={`/hoojah/${slug}`}&gt;
          &lt;h5 className="card-title text-black text-regular" dangerouslySetInnerHTML={{ __html: body }}&gt;&lt;/h5&gt;
        &lt;/Link&gt;
      &lt;/div&gt;
      &lt;div className={`card-body pt-0 ${showAddHujahButton ? "d-flex justify-content-between" : null}`}&gt;
        &lt;div className={`d-flex justify-content-${showAddHujahButton ? "between" : "around"}`}&gt;
          &lt;button className={`shadow btn btn-outline-agree btn-lg btn-circle btn-icon-16 fill-agree ${current_user_vote == "agree" ? "voted" : null} ${showAddHujahButton ? "mr-2" : null}`} onClick={() =&gt; this.handleVoteAgree()}&gt;&lt;AgreeIcon /&gt;&lt;/button&gt;
          &lt;button className={`shadow btn btn-outline-neutral btn-lg btn-circle btn-icon-16 fill-neutral neutral ${current_user_vote == "neutral" ? "voted" : null} ${showAddHujahButton ? "mr-2" : null}`} onClick={() =&gt; this.handleVoteNeutral()}&gt;&lt;NeutralIcon /&gt;&lt;/button&gt;
          &lt;button className={`shadow btn btn-outline-disagree btn-lg btn-circle btn-icon-16 fill-disagree ${current_user_vote == "disagree" ? "voted" : null}`} onClick={() =&gt; this.handleVoteDisagree()}&gt;&lt;DisagreeIcon /&gt;&lt;/button&gt;
        &lt;/div&gt;
        {showAddHujahButton ? &lt;ButtonAddHujah hujahParent={hujah} user={user} vote={current_user_vote} /&gt; : null}
      &lt;/div&gt;
      {totalVoteCount &gt; 0 ? showVoteBar : null}
      &lt;div className="card-footer d-flex justify-content-between text-grey"&gt;
        &lt;div className="d-flex align-items-center"&gt;
          &lt;Link to={`/hoojah/${hujah.slug}`} className="text-14 btn-icon-14 fill-grey no-underscore text-grey"&gt;
            &lt;VotesIcon /&gt;
            &lt;span className="ml-1"&gt;{totalVoteCount}&lt;/span&gt;
            &lt;span className="mx-2"&gt;·&lt;/span&gt;
            &lt;HujahIcon /&gt;
            &lt;span className="ml-1"&gt;{children_count}&lt;/span&gt;
          &lt;/Link&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
)   } }
</code></pre>

<p>export default HujahCard
```</p>


			</article>
		</main>
		<!-- end Main Content Section -->

		<script src="../jei-es.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	</body>
</html>
